# Sticky Observer

_[üá¨üáß In English](./README.md)_

JavaScript-–æ–±–µ—Ä—Ç–∫–∞ –¥–ª—è –Ω–∞–±–ª—é–¥–µ–Ω–∏—è –∑–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º sticky-—ç–ª–µ–º–µ–Ω—Ç–æ–≤. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç [Intersection Observer API](https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API).

–£—Ç–∏–ª–∏—Ç–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –æ—Ç—Å—Ç—É–ø—ã —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä `offsets` –∏ —É–º–µ–Ω—å—à–∞–µ—Ç –∫–∞–∂–¥—ã–π –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–π –æ—Ç—Å—Ç—É–ø –Ω–∞ 1px, –∞ –∑–∞—Ç–µ–º –∏–∑–º–µ–Ω–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–µ—Ä–µ–¥–∞–µ—Ç –∫–∞–∫ [rootMargin](https://developer.mozilla.org/en-US/docs/Web/API/IntersectionObserver/rootMargin).
–ö–æ–≥–¥–∞ Observer –æ—Ç–¥–∞–µ—Ç —Å–æ–±—ã—Ç–∏–µ, –º—ã –≤—ã—á–∏—Å–ª—è–µ–º —Ä–∞–∑–Ω–∏—Ü—É –≤ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞—Ö –º–µ–∂–¥—É –Ω–∞–±–ª—é–¥–∞–µ–º—ã–º —ç–ª–µ–º–µ–Ω—Ç–æ–º –∏ root-—ç–ª–µ–º–µ–Ω—Ç–æ–º.
–ï—Å–ª–∏ —ç—Ç–∞ —Ä–∞–∑–Ω–∏—Ü–∞ —Ä–∞–≤–Ω–∞ –ø—Ä–∏–º–µ—Ä–Ω–æ 1px, —ç–ª–µ–º–µ–Ω—Ç —Å—á–∏—Ç–∞–µ—Ç—Å—è –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–Ω—ã–º.


## –î–µ–º–æ

HTML-—Å—Ç—Ä–∞–Ω–∏—á–∫–∞: https://kokoccc.github.io/sticky-observer

CodePen: https://codepen.io/kokoc/pen/MWNxzdr


## ‚ö†Ô∏è –í–∞–∂–Ω–æ

–ï–¥–∏–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è –ø–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—é –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∏—è sticky-—ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–µ—Ç. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, Observer –¥–µ–ª–∞–µ—Ç –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Å —Ä–∞–∑–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç—å—é, —ç—Ç–æ—Ç –º–æ–º–µ–Ω—Ç –Ω–µ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç—Å—è. –°–∫—Ä–∏–ø—Ç –¥–æ–ø—É—Å–∫–∞–µ—Ç –Ω–µ–±–æ–ª—å—à—É—é –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å —á—É—Ç—å –º–µ–Ω–µ–µ —á–µ–º –≤ 1px, –∏ –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º –ø—Ä–æ–≤–µ—Ä–æ–∫ —ç—Ç–æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ø–æ–≤—ã—à–∞–µ—Ç —Ç–æ—á–Ω–æ—Å—Ç—å —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π.

–í–ø—Ä–æ—á–µ–º, –≤—Å–µ —Ä–∞–≤–Ω–æ –Ω–µ–ª—å–∑—è –¥–∞—Ç—å –≥–∞—Ä–∞–Ω—Ç–∏—é, —á—Ç–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤–æ –≤—Å–µ—Ö –±—Ä–∞—É–∑–µ—Ä–∞—Ö –Ω–∞ –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö.
–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É —Å–∫—Ä–∏–ø—Ç–∞ –ø–µ—Ä–µ–¥ —Ç–µ–º, –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–≥–æ –≤ —Å–≤–æ–µ–º –ø—Ä–æ–µ–∫—Ç–µ.


## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ (NPM-–ø–∞–∫–µ—Ç)

–î–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ `StickyObserver` –≤ –∫–∞—á–µ—Å—Ç–≤–µ NPM-–ø–∞–∫–µ—Ç–∞ –¥–æ–±–∞–≤–ª—è–µ–º –µ–≥–æ –∫–∞–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å:

```shell
# NPM
npm install @kokoccc/sticky-observer

# Yarn
yarn add @kokoccc/sticky-observer
```

–ó–∞—Ç–µ–º –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º:

```js
// Node.js
const StickyObserver = require('@kokoccc/sticky-observer')

// ES6 Module
import StickyObserver from '@kokoccc/sticky-observer'
```


## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ (–±—Ä–∞—É–∑–µ—Ä)

–ó–∞–≥—Ä—É–∑–∫–∞ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ —Ç–µ–≥ `<script>`:

```html
<!-- –£–¥–∞–ª–∏—Ç–µ '.min' –ø–µ—Ä–µ–¥ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º, —á—Ç–æ–±—ã –∑–∞–≥—Ä—É–∑–∏—Ç—å –≤–µ—Ä—Å–∏—é –±–µ–∑ –º–∏–Ω–∏—Ñ–∏–∫–∞—Ü–∏–∏ -->
<script src="https://unpkg.com/@kokoccc/sticky-observer/dist/sticky-observer.umd.min.js"></script>
```


## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

–°–æ–∑–¥–∞–µ–º –∏–Ω—Å—Ç–∞–Ω—Å `StickyObserver` –∏ –≤—ã–∑—ã–≤–∞–µ–º –º–µ—Ç–æ–¥ `observe`, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ:

```js
const observer = new StickyObserver(callback, offsets, root)
observer.observe(element) // –ó–¥–µ—Å—å –ø–µ—Ä–µ–¥–∞–µ–º HTML-—ç–ª–µ–º–µ–Ω—Ç
```

### Parameters:

`callback` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) ‚Äî —Ñ—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∫–∞–∂–¥—ã–π —Ä–∞–∑, –∫–æ–≥–¥–∞ —ç–ª–µ–º–µ–Ω—Ç —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–Ω—ã–º –∏–ª–∏ –Ω–µ–∑–∞–∫—Ä–µ–ø–ª–µ–Ω–Ω—ã–º. –ü—Ä–∏–Ω–∏–º–∞–µ—Ç 3 –∞—Ä–≥—É–º–µ–Ω—Ç–∞:

- `states` ‚Äî –æ–±—ä–µ–∫—Ç —Å –±—É–ª–µ–≤—ã–º–∏ —Ñ–ª–∞–≥–∞–º–∏: `isTop`, `isRight`, `isBottom`, `isLeft` –∏ `isStuck` (`true`, –µ—Å–ª–∏ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –∏–∑ —Ñ–ª–∞–≥–æ–≤ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∞–≤–µ–Ω `true`)
- `entries` ‚Äî —Å–º. [–æ–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ MDN](https://developer.mozilla.org/en-US/docs/Web/API/IntersectionObserver/IntersectionObserver#entries)
- `observer` ‚Äî —Å–º. [–æ–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ MDN](https://developer.mozilla.org/en-US/docs/Web/API/IntersectionObserver/IntersectionObserver#observer)

`offsets` (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) ‚Äî –æ–±—ä–µ–∫—Ç —Å –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º–∏ —Å–≤–æ–π—Å—Ç–≤–∞–º–∏: `top`, `right`, `bottom`, `left`. –ò—Ö –∑–Ω–∞—á–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å CSS-–æ—Ç—Å—Ç—É–ø–∞–º —Ü–µ–ª–µ–≤–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ —Å —Ç–µ–º–∏ –∂–µ –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏ (–≤ –ø–∏–∫—Å–µ–ª—è—Ö). –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –≤ CSS —É –Ω–∞—Å –µ—Å—Ç—å `top: 20px`, –∑–¥–µ—Å—å –º—ã –¥–æ–ª–∂–Ω—ã —É–∫–∞–∑–∞—Ç—å `{ top: 20 }`

`root` (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) ‚Äî —Å–º. [–æ–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ MDN](https://developer.mozilla.org/en-US/docs/Web/API/IntersectionObserver/IntersectionObserver#root)


## –ü—Ä–∏–º–µ—Ä

```js
const element = document.querySelector('.header')
const offsets = { top: 0 } // –ú—ã —Ö–æ—Ç–∏–º, —á—Ç–æ–±—ã —à–∞–ø–∫–∞ –∑–∞–∫—Ä–µ–ø–ª—è–ª–∞—Å—å –Ω–∞–≤–µ—Ä—Ö—É

const onIntersect = ({ isStuck }, [entry], observer) => {
  const { target } = entry // `target` –∑–¥–µ—Å—å —Ä–∞–≤–µ–Ω `element`
  target.classList.toggle('stuck', isStuck) // –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º –∫–ª–∞—Å—Å –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∏–ª–µ–π
}

// –¢—Ä–µ—Ç–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä –∑–¥–µ—Å—å –æ–ø—É—â–µ–Ω, –ø–æ—ç—Ç–æ–º—É –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –æ–±–ª–∞—Å—Ç—å –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
const observer = new StickyObserver(onIntersect, offsets)

// –ó–∞–ø—É—Å–∫–∞–µ–º –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª—å, –ø–µ—Ä–µ–¥–∞–≤ —Ü–µ–ª–µ–≤–æ–π —ç–ª–µ–º–µ–Ω—Ç
observer.observe(element)

// ...–µ—Å–ª–∏ –Ω—É–∂–Ω–æ, –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –≤—Ä–µ–º—è
observer.disconnect()
```

–ë–æ–ª–µ–µ –ø–æ–ª–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã —Å –∏—Å—Ö–æ–¥–Ω—ã–º –∫–æ–¥–æ–º –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ [–¥–µ–º–æ-—Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö](#demo).


## –õ–∏—Ü–µ–Ω–∑–∏—è

[MIT](./LICENSE)


